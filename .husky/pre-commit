#!/bin/sh
# Pre-commit hook - runs tests before allowing commit
# Prevents committing broken code

echo "ğŸ§ª Running tests before commit..."
echo ""

# Test backend if backend files changed
if git diff --cached --name-only | grep -q "^backend/"; then
  echo "ğŸ“¦ Testing backend..."
  cd backend
  npm test
  if [ $? -ne 0 ]; then
    echo "âŒ Backend tests failed! Commit blocked."
    exit 1
  fi
  cd ..
  echo "âœ… Backend tests passed"
  echo ""
fi

# Test frontend if frontend files changed
if git diff --cached --name-only | grep -q "^frontend/"; then
  echo "ğŸ’» Testing frontend..."
  cd frontend
  npm test
  if [ $? -ne 0 ]; then
    echo "âŒ Frontend tests failed! Commit blocked."
    exit 1
  fi
  cd ..
  echo "âœ… Frontend tests passed"
  echo ""
fi

echo "âœ¨ All tests passed! Commit allowed."
