<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Multi-Currency Converter</title>
  <style>
    body { font-family: sans-serif; max-width: 560px; margin: 32px auto; }
    h1 { font-size: 1.3rem; margin-bottom: 0.5rem; }
    .card { border: 1px solid #ccc; border-radius: 8px; padding: 16px; }
    .row { margin: 12px 0; }
    label { display: block; margin-bottom: 6px; font-size: 0.9rem; font-weight: 600; }
    select, input[type="number"] { width: 100%; padding: 8px 10px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
    button { padding: 8px 16px; margin-top: 8px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; font-weight: 600; }
    button:hover { background: #0056b3; }
    button:disabled { background: #ccc; cursor: not-allowed; }
    .currency-checkboxes { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 8px; margin-top: 8px; }
    .checkbox-label { display: flex; align-items: center; gap: 6px; font-size: 0.85rem; cursor: pointer; padding: 4px; border-radius: 4px; transition: background 0.2s; }
    .checkbox-label:hover { background: #f0f0f0; }
    .checkbox-label input[type="checkbox"] { width: auto; cursor: pointer; }
    .result { margin-top: 16px; padding-top: 12px; border-top: 1px solid #eee; }
    .result-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #f5f5f5; }
    .result-row:last-child { border-bottom: none; }
    .currency-code { font-weight: 600; color: #333; min-width: 60px; }
    .result-row strong { color: #007bff; }
    #status { font-size: 0.85rem; color: #666; margin-top: 12px; padding: 8px; background: #f8f9fa; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>Multi-Currency Converter</h1>
  <div class="card">
    <div class="row">
      <button id="refreshBtn">Refresh Rates</button>
    </div>

    <div class="row">
      <label for="baseCurrency">From:</label>
      <select id="baseCurrency"></select>
    </div>

    <div class="row">
      <label for="amount">Amount:</label>
      <input type="number" id="amount" value="1" min="0" step="0.01">
    </div>

    <div class="row">
      <label>Convert to:</label>
      <div id="checkboxes" class="currency-checkboxes"></div>
    </div>

    <div class="result" id="resultBox"></div>
    <div id="status"></div>
  </div>

  <script>
    const availableCurrencies = [
      'USD','EUR','GBP','JPY','CNY','SGD','AUD','CAD','CHF','HKD','NZD','KRW','INR','MYR','THB','PHP','IDR','VND'
    ];
    const currencyNames = {
      USD:'US Dollar', EUR:'Euro', GBP:'British Pound', JPY:'Japanese Yen', CNY:'Chinese Yuan', SGD:'Singapore Dollar',
      AUD:'Australian Dollar', CAD:'Canadian Dollar', CHF:'Swiss Franc', HKD:'Hong Kong Dollar', NZD:'New Zealand Dollar',
      KRW:'South Korean Won', INR:'Indian Rupee', MYR:'Malaysian Ringgit', THB:'Thai Baht', PHP:'Philippine Peso',
      IDR:'Indonesian Rupiah', VND:'Vietnamese Dong'
    };

    let rates = null;
    let selectedCurrencies = new Set(['USD','SGD','CNY','EUR','GBP','JPY']);

    function renderSelectors(){
      const baseSel = document.getElementById('baseCurrency');
      baseSel.innerHTML = availableCurrencies.map(c => `<option value="${c}">${c} - ${currencyNames[c]||''}</option>`).join('');
      baseSel.value = 'USD';

      const box = document.getElementById('checkboxes');
      box.innerHTML = availableCurrencies.map(c => {
        const checked = selectedCurrencies.has(c) ? 'checked' : '';
        return `<label class="checkbox-label"><input type="checkbox" value="${c}" ${checked}>${c}</label>`;
      }).join('');

      box.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', () => {
          if (cb.checked) selectedCurrencies.add(cb.value); else selectedCurrencies.delete(cb.value);
          convert();
        });
      });
    }

    async function fetchRates(){
      const status = document.getElementById('status');
      const btn = document.getElementById('refreshBtn');
      status.textContent = 'Loading rates...';
      btn.disabled = true;
      try {
        const symbols = availableCurrencies.filter(c => c !== 'USD').join(',');
        const res = await fetch(`https://api.frankfurter.app/latest?base=USD&symbols=${symbols}`);
        if (!res.ok) throw new Error('Rate fetch failed');
        const data = await res.json();
        rates = data.rates;
        status.textContent = 'Rates loaded (date: ' + data.date + ')';
        convert();
      } catch(e){
        console.error(e);
        status.textContent = 'Error fetching rates. Using fallback rates.';
        rates = {
          EUR:0.92, GBP:0.79, JPY:149.50, CNY:7.24, SGD:1.34, AUD:1.54, CAD:1.39, CHF:0.88,
          HKD:7.78, NZD:1.70, KRW:1310.00, INR:83.25, MYR:4.47, THB:34.85, PHP:56.50,
          IDR:15650.00, VND:24350.00
        };
        convert();
      } finally {
        btn.disabled = false;
      }
    }

    function convert(){
      const outBox = document.getElementById('resultBox');
      const status = document.getElementById('status');
      if (!rates){
        status.textContent = 'Rates not loaded yet. Click "Refresh Rates".';
        return;
      }
      status.textContent = '';

      const base = document.getElementById('baseCurrency').value;
      let amt = parseFloat(document.getElementById('amount').value);
      if (isNaN(amt) || amt < 0) amt = 0;

      let amountInUsd;
      if (base === 'USD') amountInUsd = amt;
      else {
        const baseRate = rates[base];
        if (!baseRate){ outBox.innerHTML = '<div class="result-row">Missing rate for base.</div>'; return; }
        amountInUsd = amt / baseRate;
      }

      const rows = [];
      selectedCurrencies.forEach(code => {
        if (code === base && base === 'USD') { rows.push(row(code, amountInUsd)); return; }
        if (code === 'USD') { rows.push(row(code, amountInUsd)); return; }
        const rate = rates[code];
        if (!rate){ rows.push(row(code, '-')); return; }
        rows.push(row(code, (amountInUsd * rate).toFixed(2)));
      });

      outBox.innerHTML = rows.join('');
    }

    function row(code, val){
      const safe = val === '-' ? '-' : Number(val).toFixed(2);
      return `<div class="result-row"><span class="currency-code">${code}:</span><strong>${safe}</strong></div>`;
    }

    document.getElementById('refreshBtn').addEventListener('click', fetchRates);
    document.getElementById('baseCurrency').addEventListener('change', convert);
    document.getElementById('amount').addEventListener('input', convert);
    document.getElementById('amount').addEventListener('keydown', e => { if (e.key === 'Enter') convert(); });

    renderSelectors();
    fetchRates();
  </script>
</body>
</html>
